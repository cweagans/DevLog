{"pageProps":{"note":{"id":"ghqfq24dh7bjkpabdqvstm6","title":"Configuration","desc":"","updated":1647150080616,"created":1643183994393,"custom":{},"fname":"p.doing.homelab.services.proxmox.configuration","type":"note","vault":{"fsPath":"DevLog"},"contentHash":"71ffaf1dcd463cd73b6ad5c1c5472ee9","links":[{"type":"wiki","from":{"fname":"p.doing.homelab.services.proxmox.configuration","id":"ghqfq24dh7bjkpabdqvstm6","vaultName":"DevLog"},"value":"terms.iommu","alias":"terms.iommu","position":{"start":{"line":19,"column":8,"offset":432},"end":{"line":19,"column":23,"offset":447},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"terms.iommu"}},{"type":"wiki","from":{"fname":"p.doing.homelab.services.proxmox.configuration","id":"ghqfq24dh7bjkpabdqvstm6","vaultName":"DevLog"},"value":"terms.vlan","alias":"terms.vlan","position":{"start":{"line":44,"column":160,"offset":1251},"end":{"line":44,"column":174,"offset":1265},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"terms.vlan"}},{"type":"wiki","from":{"fname":"p.doing.homelab.services.proxmox.configuration","id":"ghqfq24dh7bjkpabdqvstm6","vaultName":"DevLog"},"value":"terms.nfs","alias":"terms.nfs","position":{"start":{"line":50,"column":25,"offset":1395},"end":{"line":50,"column":38,"offset":1408},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"terms.nfs"}},{"type":"wiki","from":{"fname":"p.doing.homelab.services.proxmox.configuration","id":"ghqfq24dh7bjkpabdqvstm6","vaultName":"DevLog"},"value":"p.doing.homelab.servers.fafnir","alias":"p.doing.homelab.servers.fafnir","position":{"start":{"line":50,"column":62,"offset":1432},"end":{"line":50,"column":96,"offset":1466},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"p.doing.homelab.servers.fafnir"}},{"type":"wiki","from":{"fname":"p.doing.homelab.services.proxmox.configuration","id":"ghqfq24dh7bjkpabdqvstm6","vaultName":"DevLog"},"value":"p.doing.homelab.servers.fafnir","alias":"p.doing.homelab.servers.fafnir","position":{"start":{"line":53,"column":36,"offset":1631},"end":{"line":53,"column":70,"offset":1665},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"p.doing.homelab.servers.fafnir"}},{"type":"wiki","from":{"fname":"p.doing.homelab.services.proxmox.configuration","id":"ghqfq24dh7bjkpabdqvstm6","vaultName":"DevLog"},"value":"n.ieee-802.3ad","alias":"n.ieee-802.3ad","position":{"start":{"line":74,"column":11,"offset":2202},"end":{"line":74,"column":29,"offset":2220},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"n.ieee-802.3ad"}},{"type":"wiki","from":{"fname":"p.doing.homelab.services.proxmox.configuration","id":"ghqfq24dh7bjkpabdqvstm6","vaultName":"DevLog"},"value":"n.protocol.lacp","alias":"n.protocol.lacp","position":{"start":{"line":74,"column":39,"offset":2230},"end":{"line":74,"column":58,"offset":2249},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"n.protocol.lacp"}},{"from":{"fname":"p.doing.homelab.services.proxmox.setup","vaultName":"DevLog"},"type":"backlink","position":{"start":{"line":33,"column":4,"offset":1619},"end":{"line":33,"column":73,"offset":1688},"indent":[]},"value":"p.doing.homelab.services.proxmox.configuration","alias":"p.doing.homelab.services.proxmox.configuration"},{"from":{"fname":"p.doing.homelab.services.proxmox.setup","vaultName":"DevLog"},"type":"backlink","position":{"start":{"line":35,"column":4,"offset":1727},"end":{"line":35,"column":67,"offset":1790},"indent":[]},"value":"p.doing.homelab.services.proxmox.configuration","alias":"p.doing.homelab.services.proxmox.configuration"},{"from":{"fname":"p.doing.homelab.services.proxmox.setup","vaultName":"DevLog"},"type":"backlink","position":{"start":{"line":36,"column":4,"offset":1794},"end":{"line":36,"column":78,"offset":1868},"indent":[]},"value":"p.doing.homelab.services.proxmox.configuration","alias":"p.doing.homelab.services.proxmox.configuration"},{"from":{"fname":"p.doing.homelab.services.proxmox.setup","vaultName":"DevLog"},"type":"backlink","position":{"start":{"line":37,"column":4,"offset":1872},"end":{"line":37,"column":125,"offset":1993},"indent":[]},"value":"p.doing.homelab.services.proxmox.configuration","alias":"p.doing.homelab.services.proxmox.configuration"},{"from":{"fname":"p.doing.homelab.services.proxmox.setup","vaultName":"DevLog"},"type":"backlink","position":{"start":{"line":38,"column":7,"offset":2000},"end":{"line":38,"column":98,"offset":2091},"indent":[]},"value":"p.doing.homelab.services.proxmox.configuration","alias":"p.doing.homelab.services.proxmox.configuration"},{"from":{"fname":"p.doing.homelab.services.proxmox.setup","vaultName":"DevLog"},"type":"backlink","position":{"start":{"line":39,"column":4,"offset":2095},"end":{"line":39,"column":86,"offset":2177},"indent":[]},"value":"p.doing.homelab.services.proxmox.configuration","alias":"p.doing.homelab.services.proxmox.configuration"},{"from":{"fname":"p.doing.homelab.services.proxmox.setup","vaultName":"DevLog"},"type":"backlink","position":{"start":{"line":40,"column":4,"offset":2181},"end":{"line":40,"column":76,"offset":2253},"indent":[]},"value":"p.doing.homelab.services.proxmox.configuration","alias":"p.doing.homelab.services.proxmox.configuration"},{"from":{"fname":"p.doing.homelab.services.proxmox.setup","vaultName":"DevLog"},"type":"backlink","position":{"start":{"line":41,"column":7,"offset":2260},"end":{"line":41,"column":74,"offset":2327},"indent":[]},"value":"p.doing.homelab.services.proxmox.configuration","alias":"p.doing.homelab.services.proxmox.configuration"}],"anchors":{"configuration":{"type":"header","text":"Configuration","value":"configuration","line":8,"column":0,"depth":2},"updates-repository":{"type":"header","text":"Updates Repository","value":"updates-repository","line":10,"column":0,"depth":3},"enable-iommu":{"type":"header","text":"Enable IOMMU","value":"enable-iommu","line":21,"column":0,"depth":3},"make-proxmox-vlan-aware":{"type":"header","text":"Make Proxmox VLAN aware","value":"make-proxmox-vlan-aware","line":43,"column":0,"depth":3},"setup-nfs-for-backups":{"type":"header","text":"Setup NFS for backups","value":"setup-nfs-for-backups","line":52,"column":0,"depth":3},"schedule-backups":{"type":"header","text":"Schedule Backups","value":"schedule-backups","line":62,"column":0,"depth":4},"setup-linux-bridge-for-virtual-machines-separate-from-management-layer":{"type":"header","text":"Setup Linux Bridge for Virtual Machines Separate from management Layer","value":"setup-linux-bridge-for-virtual-machines-separate-from-management-layer","line":74,"column":0,"depth":3},"make-network-bridge-for-virtual-machines":{"type":"header","text":"Make Network Bridge for Virtual Machines","value":"make-network-bridge-for-virtual-machines","line":83,"column":0,"depth":4},"download-windows-virtio-drivers":{"type":"header","text":"Download Windows VirtIO drivers","value":"download-windows-virtio-drivers","line":94,"column":0,"depth":3}},"children":[],"parent":"scila6vssybq401kzsq1d5b","data":{}},"body":"<h1 id=\"configuration\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#configuration\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>Configuration</h1>\n<h2 id=\"configuration-1\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#configuration-1\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>Configuration</h2>\n<h3 id=\"updates-repository\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#updates-repository\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>Updates Repository</h3>\n<p>For regular updates and to avoid errors set the updates repository from the enterprise proxmox repo (subscription required) to the <code>pve-no-subscription</code> repo.</p>\n<p><img src=\"/DevLog/assets/images/2022-01-25-23-37-43.png\" alt=\"repos\"></p>\n<ol>\n<li>disable the enterprise repo</li>\n<li><code>[Add]</code></li>\n<li><code>pve-no-subscription</code></li>\n<li>run <code>apt-get update; apt dist-upgrade; reboot</code></li>\n</ol>\n<h3 id=\"enable-iommu\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#enable-iommu\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>Enable IOMMU</h3>\n<!-- markdownlint-disable MD031-->\n<p>Enable <a href=\"/DevLog/notes/0xbcevuqumdxife2dxgb30y\">iommu</a> so VM's can access hardware not made for virtualization (GPU's etc.)</p>\n<ol>\n<li>you can do this but updating the <code>/etc/default/grub</code> file\n<ul>\n<li>change <code>GRUB_CMDLINE_LINUX_ DEFAULT=\"quiet\"</code></li>\n<li>to: <code>GRUB_CMDLINE LINUX DEFAULT=\"quiet intel iommu=on\"</code></li>\n</ul>\n</li>\n<li>Then run <code>update-grub</code></li>\n<li>Then edit <code>/etc/modules</code> Add these 4 lines to it:</li>\n<li>\n<pre class=\"language-txt\"><code class=\"language-txt\">`vfio`\n`vfio_iommu_typel`\n`vfio_pci`\n`vfio_virqfd`\n</code></pre>\n</li>\n<li>Then run <code>update-initramfs -u -k all</code></li>\n<li>reboot</li>\n</ol>\n<!-- markdownlint-enable MD031-->\n<h3 id=\"make-proxmox-vlan-aware\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#make-proxmox-vlan-aware\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>Make Proxmox VLAN aware</h3>\n<ol>\n<li>go to <code>System > Network</code></li>\n<li>\"Edit\" your Linux bridge</li>\n<li>check the box for <code>VLAN aware:</code></li>\n<li>Click <code>Apply Configuration</code></li>\n</ol>\n<p>This will update <code>/etc/network/interfaces</code> with new settings and where it says <code>bridge-vids</code> you can change the default <code>2-4094</code> to be a single number for the <a href=\"/DevLog/notes/v9s04fmtizuk86nxjpv6354\">VLAN</a> of the server, or do that for individual virtual machines</p>\n<h3 id=\"setup-nfs-for-backups\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#setup-nfs-for-backups\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>Setup NFS for backups</h3>\n<p>ACTIVE This setup</p>\n<ol start=\"0\">\n<li>You need to have the <a href=\"/DevLog/notes/q4aac4wbg964ofeb5d6ytv6\">Network File System</a> share already setup so <a href=\"/DevLog/notes/82umkyemhjtdlkjgew0a2km\">Fafnir</a> needs to already be setup and mounted to the proxmox instance?</li>\n<li><code>Datacenter node \"> storage > add > nfs</code></li>\n<li><code>ID</code> ==> \"Backups\"</li>\n<li>Server IPV4 address (address to <a href=\"/DevLog/notes/82umkyemhjtdlkjgew0a2km\">Fafnir</a>?)</li>\n<li>Export <code>/mnt/storage &#x3C;++></code></li>\n</ol>\n<h4 id=\"schedule-backups\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#schedule-backups\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>Schedule Backups</h4>\n<ol>\n<li><code>Datacenter node > backup > add</code></li>\n<li>Select Node to backup</li>\n<li>Select storage share to send backups to</li>\n<li>Schedule Backups</li>\n<li>Email notification Settings</li>\n<li>Compression level (ZSTD)</li>\n<li>mode == snapshot</li>\n<li>test it\n<ol>\n<li>make a backup immediately</li>\n</ol>\n</li>\n</ol>\n<h3 id=\"setup-linux-bridge-for-virtual-machines-separate-from-management-layer\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#setup-linux-bridge-for-virtual-machines-separate-from-management-layer\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>Setup Linux Bridge for Virtual Machines Separate from management Layer</h3>\n<ol>\n<li><code>pve node > System > Network > Create > Linux Bond</code></li>\n<li><code>bond0</code></li>\n<li>Give it a IPV4 address</li>\n<li>List all the bridge ports in a space separated list</li>\n<li>choose <a href=\"/DevLog/notes/051ngzwl2msbgfmws2hj4eq\">3ad</a> mode for <a href=\"/DevLog/notes/lgl3co3ibveuv4ejvn2yso6\">LACP</a></li>\n<li>Add Comment</li>\n</ol>\n<h4 id=\"make-network-bridge-for-virtual-machines\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#make-network-bridge-for-virtual-machines\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>Make Network Bridge for Virtual Machines</h4>\n<ul>\n<li><a href=\"https://youtu.be/qTbeHpdHcqs\">https://youtu.be/qTbeHpdHcqs</a></li>\n</ul>\n<ol>\n<li><code>pve node > System > Network > Create > Linux Bridge</code></li>\n<li><code>vmbr1</code> is fine</li>\n<li>Give it a IPV4 address</li>\n<li>make it <code>VLAN aware:</code></li>\n<li>List all the bridge ports in a space separated list</li>\n<li>Add Comment</li>\n</ol>\n<h3 id=\"download-windows-virtio-drivers\"><a aria-hidden=\"true\" class=\"anchor-heading\" href=\"#download-windows-virtio-drivers\"><svg aria-hidden=\"true\" viewBox=\"0 0 16 16\"><use xlink:href=\"#svg-link\"></use></svg></a>Download Windows VirtIO drivers</h3>\n<ol>\n<li>Go To <a href=\"https://pve.proxmox.com/wiki/Windows_VirtIO_Drivers\">This page</a></li>\n<li>Click the link under <code>Installation</code> for downloading latest stable release</li>\n<li>upload iso to proxmox iso's in <code>local > ISO images > Upload</code></li>\n</ol>\n<hr>\n<strong>Backlinks</strong>\n<ul>\n<li><a href=\"/DevLog/notes/p4mog8mu5oi3u7tg97iwjb4\">Setup (DevLog)</a></li>\n</ul>","noteIndex":{"id":"root","title":"root","desc":"","updated":1641013093667,"created":1595961348801,"stub":false,"custom":{"stub":false,"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":"DevLog"},"contentHash":"b0b26527a2962dbb8bd5fb9a53ad702f","links":[],"anchors":{},"children":["rzqe5mjn3q2zfscw1roxr20","Bl9NeJmftBQJyJA3X4a6u","inm1S24v2GcN3Quf7gzDb","fmx7cfcdzale0ezna61yq5z","q6tr8q7gahfijix2ktlhcu3","yah6spesmpstech2ue2k3lq","6pxwlugphnw6vm4t8kn0j5p","i17wi8y2hgivywe08h6q6it","1st35wikvph2aew8aana21u","mijr0wvj3qz0mt9pv9xo1jv","qaf8v120h0ffvbowysjxw50","sh4851li2rsrhx47wwsirgv","fwqjigvqyfxiyl3pbpjvgdw","pxdvvln974xhe8w0alh0hoy","n6yddb1smrac5ll3l1y6wbd","g5dllyqoqkenoiz3opalzu6","kbwt8ucy0yh6bo8fl0kv9iw","beykavbe22agsufmm03hu0c","2uvuqa3c15o5r4j7sqadqvr","yr6gzhx0bhzyec6f52y66vf","4no90tcdswtuwmjm0bxnetx"],"parent":null,"data":{},"body":"\nThe hyperfixated rabbit hole diving knowledge base that is my brain looking at technology.\n"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":true,"leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2,"vaultSelectionModeOnCreate":"smart"}},"randomNote":{},"insertNote":{"initialValue":"templates"},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"copyNoteLink":{}},"workspace":{"vaults":[{"fsPath":"Norsk","visibility":"private"},{"fsPath":"DevLog"}],"journal":{"dailyDomain":"log","name":"daily","dateFormat":"yyyy.MM.dd","addBehavior":"childOfCurrent"},"scratch":{"name":"scratch","dateFormat":"yyyy.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"task":{"todoIntegration":true,"name":"task","dateFormat":"yyyy.MM.dd","addBehavior":"asOwnDomain","statusSymbols":{"":" ","wip":"wip","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"prioritySymbols":{"H":"high","M":"medium","L":"low"},"createTaskSelectionType":"selection2link"},"graph":{"zoomSpeed":1},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"enableUserTags":true,"enableHashTags":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":false,"enableEditorDecorations":true,"maxPreviewsCached":10,"maxNoteLength":204800,"dendronVersion":"0.84.0"},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enableMermaid":true,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false,"enableFrontmatterTags":true,"enableHashesForFMTags":false},"publishing":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enableMermaid":true,"enablePrettyRefs":true,"enableKatex":true,"assetsPrefix":"/DevLog","copyAssets":true,"siteHierarchies":["root"],"enableSiteLastModified":true,"siteRootDir":"docs","siteUrl":"https://{GITHUB_USERNAME}.github.io","enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"duplicateNoteBehavior":{"action":"useVault","payload":["DevLog"]},"writeStubs":false,"seo":{"title":"Dendron","description":"Personal knowledge space"},"github":{"enableEditLink":true,"editLinkText":"Edit this page on GitHub","editBranch":"master","editViewMode":"tree"},"enablePrettyLinks":true,"siteFaviconPath":"favicon.ico","siteIndex":"root"}}},"__N_SSG":true}